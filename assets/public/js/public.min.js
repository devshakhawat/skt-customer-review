jQuery((function(e){let t=document.getElementById("skt_preview");let n=document.getElementById("skt_recording");let o=document.getElementById("skt_timer-text");let i=document.getElementById("skt_startButton");let l=document.getElementById("skt_stopButton");let s=document.getElementById("skt_addButton");let a={audio:{noiseSuppression:false},video:{width:{min:480,ideal:800,max:1280},height:{min:320,ideal:470,max:720},framerate:30}};var d=document.getElementById("skt_video_modal");var r=document.getElementById("skt_modal_btn");var c=document.getElementsByClassName("skt_modal_close")[0];var y=document.getElementsByClassName("skt_no_camera")[0];var u=document.getElementsByClassName("skt_background")[0];if(r){u.onclick=function(){c.click()};c.onclick=function(){d.style.display="none";n.style.display="none";s.style.display="none"};window.onclick=function(e){if(e.target==d){d.style.display="none"}};let g=o.getAttribute("data-maxtime");let B=1e3*60*g;var m=null;function p(e,t){var n=e,o,i;m=setInterval((function(){o=parseInt(n/60,10);i=parseInt(n%60,10);o=o<10?"0"+o:o;i=i<10?"0"+i:i;t.innerHTML=o+`:`+i;t.style.display="inline-block";if(--n<0){n=e;clearInterval(m);l.click()}}),1e3)}t.controls=false;n.controls=false;var v;var f=[];var k=null;var b="video/webm";r.onclick=function(n){n.preventDefault();d.style.display="block";t.style.display="block";i.style.display="block";if(!navigator.mediaDevices.getUserMedia){alert("navigator.mediaDevices.getUserMedia not supported on your browser, use the latest version of Firefox or Chrome");y.style.display="flex";e(".skt_record_video_buttons").css({display:"none"})}else{if(window.MediaRecorder==undefined){alert("MediaRecorder not supported on your browser, use the latest version of Firefox or Chrome");y.style.display="flex";e(".skt_record_video_buttons").css({display:"none"})}else{navigator.mediaDevices.getUserMedia(a).then((function(e){k=e;t.srcObject=k;t.play();try{window.AudioContext=window.AudioContext||window.webkitAudioContext;window.audioContext=new AudioContext}catch(e){console.log("Web Audio API not supported.")}})).catch((function(t){y.style.display="flex";e(".skt_record_video_buttons").css({display:"none"})}))}}};function w(){if(k==null){alert("Could not get local stream from mic/camera")}else{i.disabled=true;l.disabled=false;f=[];if(typeof MediaRecorder.isTypeSupported=="function"){if(MediaRecorder.isTypeSupported("video/webm")){var e={mimeType:"video/webm"}}else if(MediaRecorder.isTypeSupported("video/mp4")){b="video/mp4";var e={mimeType:"video/mp4",videoBitsPerSecond:25e5}}v=new MediaRecorder(k,e)}else{v=new MediaRecorder(k)}v.ondataavailable=function(e){if(e.data&&e.data.size>0){f.push(e.data)}};v.onstart=function(){var e=B/1e3;p(e,o)};v.onstop=function(){var e=new Blob(f,{type:v.mimeType});s.href=URL.createObjectURL(e);n.src=URL.createObjectURL(e);n.controls=true;var t=Math.floor(Math.random()*1e7);switch(b){case"video/mp4":var o="video-testimonial-"+t+".mp4";break;default:var o="video-testimonial-"+t+".webm"}s.addEventListener("click",(t=>{t.preventDefault();n.style.display="none";s.style.display="none";document.getElementById("skt_startButton_text").innerText="Start Recording";let i=new File([e],o,{type:e.type});let l=new DataTransfer;l.items.add(i);document.querySelector("#skt_client_video_upload").files=l.files;document.querySelector(".skt-video-wrapper video").src=s.href;document.querySelector(".skt-video-wrapper").style.display="block";c.click()}));s.setAttribute("download",o);s.setAttribute("name",o)};v.start(200)}}i.addEventListener("click",(()=>{y.style.display="none";t.style.display="block";n.style.display="none";i.style.display="none";l.style.display="inline-block";w()}));l.addEventListener("click",(()=>{s.style.display="inline-block";t.style.display="none";n.style.display="block";o.style.display="none";l.style.display="none";i.style.display="block";document.getElementById("skt_startButton_text").innerText="Record again";clearInterval(m);o.innerText="";_()}),false);function _(){v.stop();i.disabled=false;l.disabled=true}}}));
